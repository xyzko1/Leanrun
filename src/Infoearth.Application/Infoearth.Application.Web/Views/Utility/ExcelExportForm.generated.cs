#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     此代码由工具生成。
//     运行时版本:4.0.30319.42000
//
//     对此文件的更改可能会导致不正确的行为，并且如果
//     重新生成代码，这些更改将会丢失。
// </auto-generated>
//------------------------------------------------------------------------------

namespace ASP
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Net;
    using System.Text;
    using System.Web;
    using System.Web.Helpers;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Views/Utility/ExcelExportForm.cshtml")]
    public partial class _Views_Utility_ExcelExportForm_cshtml : System.Web.Mvc.WebViewPage<dynamic>
    {
        public _Views_Utility_ExcelExportForm_cshtml()
        {
        }
        public override void Execute()
        {
            
            #line 1 "..\..\Views\Utility\ExcelExportForm.cshtml"
  
    ViewBag.Title = "导出Excel数据";
    Layout = "~/Views/Shared/_Form.cshtml";

            
            #line default
            #line hidden
WriteLiteral("\r\n<link");

WriteAttribute("href", Tuple.Create(" href=\"", 91), Tuple.Create("\"", 141)
, Tuple.Create(Tuple.Create("", 98), Tuple.Create<System.Object, System.Int32>(Href("~/Content/scripts/plugins/jqgrid/jqgrid.css")
, 98), false)
);

WriteLiteral(" rel=\"stylesheet\"");

WriteLiteral(" />\r\n");

            
            #line 6 "..\..\Views\Utility\ExcelExportForm.cshtml"
Write(System.Web.Optimization.Scripts.Render("~/Content/scripts/plugins/jqgrid/js"));

            
            #line default
            #line hidden
WriteLiteral("\r\n<script>\r\n    var gridId = learun.request(\'gridId\');\r\n    var filename = learun" +
".request(\'filename\');\r\n    $(function () {\r\n        var grid = null;\r\n        tr" +
"y {\r\n            grid= getInfoTop().learun.currentIframe().$(\"#\" + gridId);\r\n   " +
"     } catch (e) {\r\n            grid = window.parent.$(\"#\" + gridId);\r\n        }" +
"\r\n        var columnModel = grid.jqGrid(\'getGridParam\', \'colModel\');\r\n        $." +
"each(columnModel, function (i) {\r\n            var label = columnModel[i].label;\r" +
"\n            var name = columnModel[i].name;\r\n            var hidden = columnMod" +
"el[i].hidden;\r\n            if (!!label && hidden == false) {\r\n                $(" +
"\".sys_spec_text\").append(\"<li data-value=\'\" + name + \"\' title=\'\" + label + \"\'><a" +
">\" + label + \"</a><i></i></li>\");\r\n            }\r\n        });\r\n        $(\".sys_s" +
"pec_text li\").addClass(\"active\");\r\n        $(\".sys_spec_text li\").click(function" +
" () {\r\n            if (!!$(this).hasClass(\"active\")) {\r\n                $(this)." +
"removeClass(\"active\");\r\n            } else {\r\n                $(this).addClass(\"" +
"active\").siblings(\"li\");\r\n            }\r\n        });\r\n    });\r\n    //确定导出\r\n    f" +
"unction AcceptClick() {\r\n        var exportField = [];\r\n        $(\'.sys_spec_tex" +
"t \').find(\'li.active\').each(function () {\r\n            var value = $(this).attr(" +
"\'data-value\');\r\n            exportField.push(value);\r\n        });\r\n        var c" +
"olumnJson, rowJson = null;\r\n        try {\r\n            columnJson = getInfoTop()" +
".learun.currentIframe().$(\"#\" + gridId).jqGrid(\'getGridParam\', \'colModel\');\r\n   " +
"     } catch (e) {\r\n            columnJson = window.parent.$(\"#\" + gridId).jqGri" +
"d(\'getGridParam\', \'colModel\');\r\n        }\r\n        try {\r\n            rowJson = " +
"getInfoTop().learun.currentIframe().$(\"#\" + gridId).jqGrid(\'getRowData\');\r\n     " +
"   } catch (e) {\r\n            rowJson = window.parent.$(\"#\" + gridId).jqGrid(\'ge" +
"tRowData\');\r\n        }\r\n        $(\'#executeexcel\').remove();\r\n        var $form " +
"= $(\"<form id=\'executeexcel\' method=\'post\' action=\'\" + getInfoTop().contentPath " +
"+ \"/Utility/ExecuteExportExcel\' style=\'display:none;\'>\");\r\n        var $input = " +
"$(\"<input type=\'hidden\' name=\'columnJson\' value=\'\" + JSON.stringify(columnJson) " +
"+ \"\'><input type=\'hidden\' name=\'rowJson\' value=\'\" + JSON.stringify(rowJson) + \"\'" +
"><input type=\'hidden\' name=\'exportField\' value=\'\" + String(exportField) + \"\'><in" +
"put type=\'hidden\' name=\'filename\' value=\'\" + escape(filename) + \"\'>\");\r\n        " +
"$(\"body\").append($form);\r\n        $form.append($input).submit();\r\n    }\r\n</scrip" +
"t>\r\n<div");

WriteLiteral(" style=\"margin: 5px;\"");

WriteLiteral(">\r\n    <div");

WriteLiteral(" class=\"alert alert-danger\"");

WriteLiteral(" style=\"margin-bottom: 5px;\"");

WriteLiteral(">\r\n        <i");

WriteLiteral(" class=\"fa fa-question-circle\"");

WriteLiteral(" style=\"position: relative; top: 1px; font-size: 15px; padding-right: 5px;\"");

WriteLiteral("></i>\r\n        注：请勾选需要导出的字段\r\n    </div>\r\n</div>\r\n<div");

WriteLiteral(" style=\"margin: 5px;\"");

WriteLiteral(">\r\n    <ul");

WriteLiteral(" class=\"sys_spec_text\"");

WriteLiteral(">\r\n    </ul>\r\n</div>\r\n");

        }
    }
}
#pragma warning restore 1591
