<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
    <link href="Content/scripts/plugins/openLayer/css/map.css" rel="stylesheet" />
    <link href="Content/styles/font-awesome.min.css" rel="stylesheet" />
    <!--  <link href="Content/scripts/plugins/map/maptheme.css" rel="stylesheet" />-->
    <link href="Content/scripts/plugins/map/themify-icons.css" rel="stylesheet" />
    <link href="Content/scripts/plugins/openLayer/css/ol.css" rel="stylesheet" />
    <link href="Content/scripts/plugins/map/map.css" rel="stylesheet" />
    <link href="Content/scripts/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="Content/scripts/plugins/tree/tree.css" rel="stylesheet" />
    <link href="Content/styles/learun-ui.css" rel="stylesheet" />
    <!--<script src="Content/scripts/plugins/openLayer/jquery.min.js"></script>-->
    <script src="Content/scripts/jquery/jquery-1.10.2.min.js"></script>
    <script src="Content/scripts/bootstrap/bootstrap.min.js"></script>
    <script src="Content/scripts/plugins/jquery.md5.js"></script>

    <script src="Content/scripts/plugins/openLayer/ol-debug.js"></script>
    <!--<script src="Content/scripts/plugins/openLayer/ol.js"></script>-->
    <script src="Content/scripts/plugins/openLayer/itelluro.ol.js"></script>
    <script src="Content/scripts/plugins/openLayer/itelluro.tianditu.js"></script>
    <script src="Content/scripts/plugins/openLayer/measuretool.js"></script>

    <script src="Content/scripts/plugins/tree/tree.js"></script>
    <script src="Content/scripts/plugins/map/map.js"></script>
    <script src="Content/scripts/plugins/jquery-ui/jquery-ui.min.js"></script>
    <script src="Content/scripts/utils/base/learun.base.js"></script>
    <script src="Content/scripts/utils/base/learun.base.extensions.js"></script>
    <script src="Content/scripts/utils/base/learun.base.plugin.js"></script>
    <script src="Content/scripts/utils/base/learun.old.js"></script>
    <script src="Content/scripts/plugins/infoearthcustom/queryControl.js"></script>
    <script src="Content/scripts/plugins/districts/multiDistricts.js"></script>
    <script src="Content/scripts/plugins/datepicker/WdatePicker.js"></script>
    <!--<script src="Content/scripts/ssoapi.js"></script>-->
    <!--<script src="Content/scripts/ssohx.js"></script>-->

    <script src="Content/scripts/plugins/districts/districts.js"></script>
    <script src="Content/scripts/plugins/infoearthcustom/timeQuantum.js"></script>
    <link href="Content/scripts/plugins/select2/css/select2.css" rel="stylesheet" />
    <script src="Content/scripts/plugins/select2/select2.js"></script>
    <script src="Content/scripts/plugins/infoearthcustom/comboxSearchControl.js"></script>
    <script src="Content/scripts/plugins/Kneecoordinate/Kneecoordinate.js"></script>
    <script src="Content/scripts/plugins/infoearthcustom/degreeConvert.js"></script>
    <script src="Content/scripts/plugins/infoearthcustom/MultMediaControl.js"></script>

    <script>
        $(function () {
            InitControl();
            //SSO.config({
            //    userName: "System",
            //    passWord: $.md5("0000"),
            //    ssoBaseUri: "http://localhost:4064/",
            //    baseUrl: "http://localhost:4064/"
            //});

            //SSO.GetMenuByBusinessCodeAndUserID("02");

            //SSO.FetchAllAuthDistrictZone();

            var contentPath = "http://localhost:4066/";
            top.contentPath = "";
            var treeNodes = "[{\"id\":\"da5d4103-8016-4380-a4f8-28a3983274e3\",\"text\":\"基础\",\"value\":\"{\"zoomlevel\":1,\"url\":\"#\",\"dataserverkey\":\"#\",\"tilesize\":512,\"zerolevelsize\":72.0}\",\"img\":\"fa fa-navicon\",\"parentnodes\":\"0000\",\"showcheck\":false,\"isexpand\":true,\"complete\":true,\"hasChildren\":true,\"ChildNodes\":[{\"id\":\"43bcad39-b0f9-490e-a79c-0fdca8c839da\",\"text\":\"全球地质图S服务\",\"value\":\"{\"zoomlevel\":4,\"url\":\"http://192.168.100.18:8088/iTelluro.Server.TianDiTu/Service/GIS/gis.ashx\",\"dataserverkey\":\"全球地质图S\",\"tilesize\":512,\"zerolevelsize\":72.0}\",\"img\":\"fa fa-navicon\",\"parentnodes\":\"da5d4103-8016-4380-a4f8-28a3983274e3\",\"showcheck\":true,\"isexpand\":false,\"complete\":true,\"hasChildren\":false,\"ChildNodes\":[]},{\"id\":\"bf139995-1fa3-46ca-97b2-a9b9b8c445f8\",\"text\":\"国界数据集\",\"value\":\"{\"zoomlevel\":6,\"url\":\"http://192.168.100.18:8088/iTelluro.Server.TianDiTu/Service/GIS/gis.ashx\",\"dataserverkey\":\"国界S\",\"tilesize\":512,\"zerolevelsize\":72.0}\",\"img\":\"fa fa-navicon\",\"parentnodes\":\"da5d4103-8016-4380-a4f8-28a3983274e3\",\"showcheck\":true,\"isexpand\":false,\"complete\":true,\"hasChildren\":false,\"ChildNodes\":[]}]}]";
            //var queryUrl = contentPath + "Map/GetMapDatas";
            //$.ajax({
            //    url: 'Map/GetMapDatas',
            //    async: false,
            //    type: "GET",
            //    success: function (data) {
            //        treeNodes = data;
            //    }, error: function (e) {
            //    },
            //    cache: false
            //});

            var nodes = [
                {
                    id: "da5d4103-8016-4380-a4f8-28a3983274e3",
                    text: "基础",
                    value: {
                        zoomlevel: 1,
                        url: "#",
                        dataserverkey: "#",
                        tilesize: 512,
                        zerolevelsize: 72.0
                    },
                    img: "fa fa-navicon",
                    parentnodes: "0000",
                    showcheck: false,
                    isexpand: true, complete: true,
                    hasChildren: true,
                    ChildNodes: [{
                        id: "43bcad39-b0f9-490e-a79c-0fdca8c839da",
                        text: "全球地质图S服务",
                        value: {
                            zoomlevel: 4, url: "http://192.168.100.18:8088/iTelluro.Server.TianDiTu/Service/GIS/gis.ashx", dataserverkey: "全球地质图S",
                            tilesize: 512, zerolevelsize: 72.0
                        },
                        img: "fa fa-navicon",
                        parentnodes: "da5d4103-8016-4380-a4f8-28a3983274e3",
                        showcheck: true, isexpand: false, complete: true,
                        hasChildren: false, ChildNodes: []
                    },
                        {
                            id: "bf139995-1fa3-46ca-97b2-a9b9b8c445f8", text: "国界数据集",
                            value: {
                                zoomlevel: 6, url: "http://192.168.100.18:8088/iTelluro.Server.TianDiTu/Service/GIS/gis.ashx",
                                dataserverkey: "国界S", tilesize: 512, zerolevelsize: 72.0
                            }, img: "fa fa-navicon",
                            parentnodes: "da5d4103-8016-4380-a4f8-28a3983274e3",
                            showcheck: true, isexpand: false, complete: true, hasChildren: false, ChildNodes: []
                        }]
                }];

            var dataSet = {
                baseMap: {
                    map: {
                        zoomlevel: 14,
                        dataserverkey: "天地图地图S",
                        url: "http://192.168.100.18:8088/iTelluro.Server.TianDiTu/Service/DOM/dom.ashx",
                        tilesize: 512,
                        zerolevelsize: 36
                    },
                    note: {
                        zoomlevel: 14,
                        dataserverkey: "天地图地图注记S",
                        url: "http://192.168.100.18:8088/iTelluro.Server.TianDiTu/Service/DOM/dom.ashx",
                        tilesize: 512,
                        zerolevelsize: 36
                    }
                },
                statelliteMap: {
                    map: {
                        zoomlevel: 14,
                        dataserverkey: "天地图影像S",
                        url: "http://192.168.100.18:8088/iTelluro.Server.TianDiTu/Service/DOM/dom.ashx",
                        tilesize: 512,
                        zerolevelsize: 36
                    },
                    note: {
                        zoomlevel: 14,
                        dataserverkey: "天地图影像注记S",
                        url: "http://192.168.100.18:8088/iTelluro.Server.TianDiTu/Service/DOM/dom.ashx",
                        tilesize: 512,
                        zerolevelsize: 36
                    }
                },
                proviceMap: {
                    zoomlevel: 14,
                    dataserverkey: "天地图影像注记S",
                    url: "",
                    tilesize: 512,
                    zerolevelsize: 36
                },
                gisLayer: nodes
            };
            var loc = [{
                url: "",
                longitude: 117,
                latitude: 35
            }];
            var me = $("#mapTest").mapCtl({
                mapwidth: 1500,
                mapheight: 800,
                isShowGisLayer: true,
                dataset: dataSet
            });

            //me.addLocation(loc);
            //box
            //me.drawShape("circle");
            $("#yuan").click(function () {
                me.drawShape("circle");
            });
            $("#fang").click(function () {
                me.drawShape("box");
            });

            $("#zb").click(function () {
                var extent = me.getExtent();
                alert(extent);
            });
            var tag = [{
                url: 'Content/images/duihao_03.png',
                longitude: 117.5,
                latitude: 34.5,
                popupHtml: "123"
            }];

            var tag1 = [{
                url: 'Content/images/duihao_03.png',
                longitude: 117.5,
                latitude: 34.5,
                location: [117.5, 34.5],
                popupHtml: "<p>您点击了灾害点图标' + e + '····<a href=\"#\" style=\"color:#b3cee0\">' + i + '</a></p>"
            }];
            $("#addtag").click(function () {
                me.addLocation(tag1);

            });
            var point = [117, 35];
            $("#addpoint").click(function () {
                me.addTagging("Point", point);
            });

        });
        //初始化控件
        function InitControl() {
            var html = " <table><tr><td width=\"40px\">省</td><td> <div id=\"PROVINCE\" type=\"select\" multiples class=\"ui-select\" style=\"float: left; width: 160px; margin-right: 1px;\"></div></td></tr>" +
               "<tr><td width=\"40px\">市</td><td><div id=\"CITY\" type=\"select\" class=\"ui-select\" multiples style=\"float: left; width: 160px; margin-right: 1px;\"></div></td></tr>" +
           "<tr><td width=\"40px\">区</td><td><div id=\"COUNTY\" type=\"select\" class=\"ui-select\" multiples style=\"float: left; width: 160px; margin-right: 1px;\"></div> </td></tr></table>";
            var district = $("#districtControl").mulDistrictsCtl({
                provinceId: "370000",
                selectProviceId: "370000",
                selectCityId: "",
                selectCounty: "",
                html: html
            });



            var query = $("#queryControl").queryControl({
                tableName: "Base_Area",
                width: 360,
                height: 350,
                valueIsVisible:true
            });
            var cmbsearch = $("#cmbSearch").comboxSearchControl({
                item: "Client_Trade",
                value: "777eb7b5-54b8-4d46-b8a5-4fea1e19556c"
            });
            var kneecoor = $("#kneecoordinate").kneecoordinateCtl();
            var time = $("#time").timeQuantumControl({
                startTime: "2018-1-27",
                endTime: "2018-1-30"
            });
            $("#btnTest").click(function () {
                var value = cmbsearch[0].d.GetComboxValue()
                var testSql = query[0].d.GetSql();
                console.log(testSql);
                var testData = query[0].d.GetData();
                console.log(testData);
            });
            var _degree = $("#degreeConvert").degreeConvertControl({
                degree: 115.83
            });
            $("#btnDegree").click(function () {
                var degree = _degree[0].d.GetDegree();
                alert(degree);
            });
            $("#xzqh").click(function () {
                var value = district.getDistrictValue()
                console.log(value);
            });
            $("#multMediaControl").MultMediaControl();
        }
    </script>
</head>
<body>
    <div id="time" style="width: 100%; padding: 20px;clear:both;margin-top:3px;"></div>
    <div class="pane" id="kneecoordinate"></div>
    <div id="cmbSearch" style="width: 100%; padding: 20px;clear:both;margin-top:3px;"></div>

    <div id="queryControl" style="width: 100%; padding: 20px;clear:both;margin-top:3px;"></div>
    <div>
        <input type="button" id="btnTest" value="获取sql"  />
    </div>
    
    <div id="degreeConvert" style="width: 100%; padding: 20px; clear: both; margin-top: 3px;"></div>
    <div>
        <input type="button" id="btnDegree" value="获取度" />
    </div>
    <div id="multMediaControl" style="width: 100%; padding: 20px; clear: both; margin-top: 3px; border-left: 1px solid blue; border-bottom: 1px solid blue; border-right: 1px solid blue; border-top: 1px solid blue; "></div>
    <div id="districtControl" style="width: 100%; padding: 20px;"></div>

    <h1>地图控件测试</h1>
    <div>
        <button id="yuan">画圆</button>
        <button id="fang">画方</button>
        <button id="zb">获取坐标</button>
        <button id="addtag">添加Tag</button>
        <button id="addpoint">添加点</button>
      <button id="xzqh">获取行政区划</button></div>
    <div id="mapTest"></div>
    
</body>
</html>
